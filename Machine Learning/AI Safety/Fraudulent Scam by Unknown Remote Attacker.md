Created: 2023-12-23 16:51
#note

**The breach:** Indirect prompt injection can lead to cross-site scripting (XSS [1](https://owasp.org/www-community/attacks/xss/)) and cross-plugin request forgery (CPRF [2](https://owasp.org/www-community/attacks/csrf#:~:text=Overview,which%20they're%20currently%20authenticated.)), which are two separate, but close-knit vulnerabilities. Together, they can be used to impact end user behavior.

**The impact:** [XSS](https://owasp.org/www-community/Types_of_Cross-Site_Scripting?ref=txt.cohere.com) is a vulnerability that allows attackers to inject malicious scripts into web pages viewed by other users. This occurs when an attacker can place harmful code into a web application's input field (like a comment box). If the application doesn't properly check this input, it will include the malicious script in the content it displays. When other users visit the affected page, their browsers will run the script, which can do various harmful things, like stealing their data or taking over their session on the website. For example, consider a generative AI consumer application that incorporates several plugins. If this application’s underlying model is vulnerable to a [confused deputy](https://en.wikipedia.org/wiki/Confused_deputy_problem?ref=txt.cohere.com) attack, it might activate another plugin. The attacker's script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page. Combined with a successful CPRF attack, it can force the user to perform state-changing requests like transferring funds, changing their email address, and so forth. If the user is an administrative account, CPRF can compromise the entire web application.

**The mitigation**: Both XSS and CPRF are significant security threats in web applications, and they require several mitigation strategies. XSS is mainly about untrusted data being sent to a web browser without proper validation or escaping, while CPRF involves tricking a user's browser into performing actions on a trusted website without the user's knowledge. Both of these scenarios can benefit from [commonly-used mitigation techniques](https://llmtop10.com/llm07/?ref=txt.cohere.com), including human-in-the-loop design, so one plugin cannot invoke another, and tailor permissions for sensitive information.

## References
1. [Cohere](https://txt.cohere.com/the-state-of-ai-security/)
2. [CPRF on ChatGPT](https://embracethered.com/blog/posts/2023/chatgpt-webpilot-data-exfil-via-markdown-injection/)